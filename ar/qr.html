<!doctype HTML>
<html>
<script src="https://aframe.io/releases/0.9.0/aframe.min.js"></script>
<script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.6.2/aframe/build/aframe-ar.js"> </script>
<script src="https://cozmo.github.io/jsQR/jsQR.js"></script>
<script>
  var canvasElement = document.createElement("canvas");
  var canvasContext = canvasElement.getContext("2d");
	AFRAME.registerComponent('registerevents', {
		init: function () {
			var marker = this.el;
			marker.addEventListener('markerFound', function() {
				var markerId = marker.id;
        return;
        video = document.querySelector("video");
        if (video && video.readyState === video.HAVE_ENOUGH_DATA) {
          canvasElement.height = video.videoHeight;
          canvasElement.width = video.videoWidth;
          canvasContext.drawImage(
            video,
            0,
            0,
            canvasElement.width,
            canvasElement.height
          );
          var imageData = canvasContext.getImageData(
            0,
            0,
            canvasElement.width,
            canvasElement.height
          );
          var qrCode = jsQR(imageData.data, imageData.width, imageData.height);
          if (qrCode && qrCode.data !== "") {
            console.log("QR Code Data - " + qrCode.data);
          } else {
            console.log("no qr code found");
          }
        }
			});
			marker.addEventListener('markerLost', function() {
        console.log('markerLost');
				var markerId = marker.id;
        console.log(this.id);
			});
		}
	});
</script>

<body style='margin : 0px; overflow: hidden;'>
    <a-scene embedded arjs='detectionType:mono_and_matrix; matrixCodeType: 4x4; sourceType: webcam; debugUIEnabled: false;' vr-mode-ui="enabled: false">
         <a-marker id="number5" type='barcode' value='5' emitevents="true" registerevents>
          <a-circle material="side: double; color: #EF2D5E; transparent: true; opacity: 0.5" color="#7BC8A4" radius="0.5" rotation='-90 0 0' position='0 0 0'>
          </a-circle>
        </a-marker>

        <a-marker id="python" preset='custom' type='pattern' url='python.patt'>
            <a-circle material="side: double; color: #EF2D5E; transparent: true; opacity: 0.5" color="#7BC8A4" radius="0.5" rotation='-90 0 0' position='0 0 0'>
              </a-circle>
        </a-marker>

        <a-marker id="hiro" preset="hiro" registerevents>
            <a-circle material="side: double; color: #EF2D5E; transparent: true; opacity: 0.5" color="#7BC8A4" radius="0.5" rotation='-90 0 0' position='0 0 0'>
            </a-circle>
        </a-marker>

      <a-entity camera></a-entity>
    </a-scene>

 
  </body>
</html>


